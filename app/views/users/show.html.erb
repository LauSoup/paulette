<!-- Banner -->
<div class="banner">
  <div class="container">
    <h1 id="banner-title"><%= @user.name.capitalize %></h1>
    <p>A true hen lover!</p>
  </div>
</div>

<!-- Page container -->
<div class="cards-container text-align-center">

  <!-- User Info Card -->
  <!-- Bootstrap classes to be removed. Wait for Noeline's seeds! -->
  <div class="user-info-card">
    <!-- Contains the info about the user -->
      <div class="farmer-photo-info">
        <% if @user.photo.attached? %>
          <%= cl_image_tag @user.photo.key %>
        <% else %>
          <%= image_tag("https://poulespondeuses.com/wp-content/uploads/2018/02/Tonio-Poule-1080x810.jpg") %>
        <% end %>

      </div>
      <div class="card-body">
        <h3 class="card-title"><%= @user.name.capitalize %></h3>
        <p class="card-text bold-info-p"><i class="fas fa-map-pin"></i> <%= @user.address %></p>
        <p class="card-text"><%= @user.description %></p>
        <a href="#reviews">Reviews ðŸ‘‡</a>
        <div class="text-right">
          <% if policy(@user).update? %>
            <%= link_to "Modify", edit_user_path(current_user), class: "btn-yellow small-btn right-button" %>
          <% end %>
        </div>
      </div>
    </div>

  <div class="card">

    <div class="card-body">

      <h3 class="card-title">His hens!</h3>

      <div class="text-right">
        <% if current_user == @user %>
          <% if policy(Hen).new? %>
            <%= link_to "Add a new hen",  new_user_hen_path(current_user), class: "btn-yellow small-btn" %>
          <% end %>
        <% end %>
      </div>

      <div class="hen-cards">
        <% if policy(Request).new? %>
          <% @hens.each do |hen| %>
          <!-- Hen card. -->
          <% hen.disponibility ? availability_filter = "" : availability_filter = "grey-filter"%>
              <div class="hen-card <%= availability_filter %>">
                <% if hen.photo.attached? %>
                  <%= cl_image_tag hen.photo.key %>
                <% else %>
                  <%= image_tag("australorp.png") %>
                <% end %>
                <div class="card-body">
                  <h5 class="card-title"><%= hen.name %></h5>
                  <p class="card-text"><%= hen.breed %></p>
                  <p class="card-text">Price: <%= hen.price %>â‚¬.</p>
                  <p class="card-text"><%= hen.name %> is <%= hen.age.round %> years old!</p>

                  <% if hen.disponibility == true %>
                    <%= link_to new_hen_request_url(hen) do %>
                      <div class="text-right">
                        <i class="fa fa-arrow-right" aria-hidden="true"></i>Book <%= hen.name %>
                      </div>
                    <% end %>
                  <% else %>
                    <div class="text-right">
                      <i class="fa fa-ban" aria-hidden="true"></i> Victime de son succÃ¨s
                    </div>
                  <% end %>
                  <% if policy(hen).update? %>
                    <%= link_to edit_user_hen_path(@user, hen) do %>
                        <div class="text-right">
                          <i class="fa fa-arrow-right" aria-hidden="true"></i>Update <%= hen.name %>
                        </div>
                      <% end %>
                    <% end %>
                </div>
              </div>
          <% end %>
        <% else %>
          <% @hens.each do |hen| %>
          <!-- Hen card. -->
          <% hen.disponibility ? availability_filter = "" : availability_filter = "grey-filter"%>
          <div class="hen-card <%= availability_filter %>">
            <%= cl_image_tag hen.photo.key %>
            <div class="card-body">
              <h5 class="card-title"><%= hen.name %></h5>
              <p class="card-text"><%= hen.breed %></p>
              <p class="card-text">Price: <%= hen.price %>â‚¬.</p>
              <p class="card-text"><%= hen.name %> is <%= hen.age.round %> years old!</p>
            </div>
          </div>
          <% end %>
        <% end %>
      </div>
    </div>

  <!--   Review ------------------------------------------------------ -->

    <div class="reviews">
      <a name="reviews"></a>
      <h5 style="text-align: center">Let's see <%= @user.name %> reviews</h5>
   </div>
    <div class="card-review">
     <img src="https://source.unsplash.com/featured/?person">
      <div class="card-review-infos">
        <% @hens.each do |hen| %>
          <% hen.reviews.each do |review|  %>
          <li style="list-style: none"> <em> Date: </em> <%= review.created_at %><br>
            <% review.rating.times do %>
              <i class='fas fa-star'></i>
            <% end %>
            <% blank_stars = 5 - review.rating %>
            <% blank_stars.times do %>
              <i class="far fa-star"></i>
            <% end %> <br>
          <p><strong> Comment : </strong></b></em><%= review.content %> </p> </li>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
